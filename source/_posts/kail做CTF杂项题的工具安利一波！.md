---
title: kailåšCTFæ‚é¡¹é¢˜çš„å·¥å…·å®‰åˆ©ä¸€æ³¢ï¼
date: 2020-04-08 15:04:05
tags: kail
categories: æŠ€æœ¯
photos:  https://cdn.jsdelivr.net/gh/yremp/cdn@2.1.5/img/cover/(2).jpg.webp
---



ï»¿å‰è¨€ï¼šä¸Šå‘¨çš„æ¯”èµ›ï¼ŒçŸ¥è¯†å’Œå·¥å…·éƒ½è¡¥å……äº†ä¸€æ³¢ï¼Œç€å®å“åˆ°æˆ‘è¿™è€èœé¸Ÿäº†ã€‚

## 1.blind-watermark
è¿™ä¸ªå·¥å…·ä¸»è¦æ˜¯è§£å†³ç›²æ°´å°é—®é¢˜ã€‚
[å…‹éš†åˆ°kailé‡Œ](https://github.com/linyacool/blind-watermark.git)

```
python encode.py --image <image file> --watermark <watermark file> --result <result file>

python decode.py --original <original image file> --image <image file> --result <result file>

Use --alpha to change the alpha (default 5.0).
```
è¿™ä¸ªå·¥å…·åˆ†ä¸ºåŠ å¯†ï¼ˆencodeï¼‰å’Œè§£å¯†ï¼ˆdecodeï¼‰ä¸¤éƒ¨åˆ†ã€‚
åŸå§‹æ–‡ä»¶ï¼Œå¸¦æœ‰æ°´å°çš„æ–‡ä»¶ï¼Œè§£å‡ºæ¥çš„æ–‡ä»¶ï¼ˆæˆ–åŠ å¯†å‡ºæ¥çš„æ–‡ä»¶ï¼‰
åœ¨çœ‹ä¸æ‡‚æˆ‘ä¹Ÿæ²¡åŠæ³•äº†ã€‚
## 2.F5éšå†™
F5éšå†™å…¨ç§°F5-steganographyã€‚
1.kailå®‰è£…å‘½ä»¤ï¼š`git clone https://github.com/matthewgao/F5-steganography`
2.è¿›å…¥F5-steganographyæ–‡ä»¶å¤¹ï¼Œç©ºç™½å¤„æ‰“å¼€å‘½ä»¤ç»ˆç«¯ã€‚
3.java Extract å›¾ç‰‡çš„ç»å¯¹è·¯å¾„/123456.jpg -p 123456
**åˆ‡è®°æ˜¯ç»å¯¹è·¯å¾„ï¼Œå¹¶ä¸”  -p  åé¢æ˜¯å¯†ç ã€‚**
4.åœ¨æ–‡ä»¶å¤¹å†…æ‰¾åˆ°å¹¶æ‰“å¼€output.txtæ–‡ä»¶ï¼Œå°±ä¼šæœ‰ä½ æƒ³è¦çš„ç­”æ¡ˆã€‚
## 3.outguesséšå†™
kailç»ˆç«¯å‘½ä»¤è¾“å…¥ git clone https://github.com/crorvick/outguess è¿›è¡Œä¸‹è½½ï¼Œä¸‹è½½å®Œæˆåè¿›å…¥outguessæ–‡ä»¶å¤¹ï¼Œå³å‡»æ‰“å¼€ç»ˆç«¯ï¼Œ
æ‰§è¡Œå‘½ä»¤./configure && make && make install è¿›è¡Œç¼–è¯‘åŠå®‰è£…ã€‚
outguess -k 'å¯†é’¥' -r å›¾ç‰‡çš„ç»å¯¹è·¯å¾„ flag.txtè§£å¯†ï¼Œflag.txtï¼ˆåœ¨outguessæ–‡ä»¶å¤¹å†…ï¼‰ä¸­çš„å†…å®¹æ˜¯è¦éšè—çš„ç­”æ¡ˆã€‚
outguess -k "secret key" -d flag.txt 0.jpg 1.jpgåŠ å¯†ï¼ŒåŠ å¯†ä¹‹åï¼Œ0.jpgä¼šè¦†ç›–1.jpgã€‚
## 4.steghideå·¥å…·
å¦‚æœä½ çš„Kali Linuxè¿˜æ²¡æœ‰æ›´æ–°è¿‡çš„è¯ï¼Œé‚£ä¹ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ›´æ–°ã€‚
ã€€ã€€apt-get upgrade
ã€€ã€€å½“ç³»ç»Ÿæ›´æ–°å®Œæ¯•åï¼Œå°±å¯ä»¥é‡‡å–åœ¨çº¿å®‰è£…çš„æ–¹å¼æŠŠsteghideå·¥å…·è£…å…¥åˆ°ä½ çš„ç³»ç»Ÿä¸­ã€‚apt-get install steghide
ã€€ã€€å¦‚æœæƒé™ä¸å¤Ÿçš„è¯éœ€è¦åŠ ï¼Œåœ¨å‘½ä»¤å‰é¢åŠ sudo,ç„¶åè¾“å…¥è‡ªå·±çš„å¯†ç å°±ğŸ†—äº†ã€‚
ç”¨æ³•ç¤ºä¾‹ï¼š
å°†post.txtæ–‡ä»¶éšè—åˆ°xxx.jpgä¸­ï¼š
steghide embed -cf xxx.jpg -ef post.txt -p 123456ï¼ˆä¸åŠ -på‚æ•° ä¸è®¾ç½®å¯†ç  ï¼‰
ä»xxx.jpgè§£å‡ºpost.txt:
steghide extract -sf xxx.jpg ï¼ˆå›¾ç‰‡è·¯å¾„ï¼‰-p 123456ï¼ˆ-p å¯†ç ï¼‰
steghideä¹Ÿå¯ä»¥ç”¨æ¥çˆ†ç ´å¯†ç ï¼š
éœ€è¦shellè„šæœ¬ï¼š`#bruteStegHide.sh 

>        #bruteStegHide.sh
>        #!/bin/bash
>     
>     for line in `cat $2`;do
>     steghide extract -sf $1 -p $line > /dev/null 2>&1
>     if [[ $? -eq 0 ]];then
>     echo 'password is: '$line
>     exit
>     fi
>     done



ç”¨æ³•ï¼š
       # ./bruteStegHide.sh test.jpg passwd.txt
       å‰©ä¸‹çš„å¯†ç å°±å‡ºæ¥äº†ã€‚
## 5.æ–‡ä»¶åˆ†ç¦»å·¥å…·ï¼ˆbinwalk,foremostï¼‰
1.binwalkçš„å®‰è£…

```
git clone https://github.com/devttys0/binwalk
cd binwalk
python setup.py install
```
è¿è¡Œå‘½ä»¤ï¼š

> binwalk -D "archive:zip" -D "image:jpg" hehe.jpg   å¯ä»¥ç›´æ¥åˆ†ç¦»æ–‡ä»¶

ä¹Ÿå¯ä»¥ä½¿ç”¨ddå‘½ä»¤åˆ†ç¦»æ–‡ä»¶ï¼Œå¦‚:`dd if=hehe.jpg of=hehe1.zip bs=1 skip=54163`

2ã€Binwalkçš„æå–ä¸åˆ†æ

2.1ã€å›ºä»¶æ‰«æ

ã€€ã€€å‘½ä»¤ï¼šbinwalk firmware.bin      é€šè¿‡æ‰«æèƒ½å¤Ÿæ™ºèƒ½åœ°å‘ç°ç›®æ ‡æ–‡ä»¶ä¸­åŒ…å«çš„æ‰€æœ‰å¯è¯†åˆ«çš„æ–‡ä»¶ç±»å‹ã€‚

2.2ã€æå–æ–‡ä»¶

ã€€ã€€å‘½ä»¤ï¼šbinwalk -e firmware.bin      é€‰é¡¹â€œ-e"å’Œâ€œ--extract"ç”¨äºæŒ‰ç…§å®šä¹‰çš„é…ç½®æ–‡ä»¶ä¸­çš„æå–æ–¹æ³•ä»å›ºä»¶ä¸­æå–æ¢æµ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿã€‚

ã€€ã€€å‘½ä»¤ï¼šbinwalk -Me firmware.bin      é€‰é¡¹â€œ-M"å’Œâ€œ--matryoshka"ç”¨äºæ ¹æ®magicç­¾åæ‰«æç»“æœè¿›è¡Œé€’å½’æå–ï¼Œä»…å¯¹"-e"å’Œâ€œ--dd"é€‰é¡¹æœ‰æ•ˆã€‚

ã€€ã€€å‘½ä»¤ï¼šbinwalk -Me -d 5 firmware.bin      é€‰é¡¹â€œ-d"å’Œâ€œ--depth=<int>"ç”¨äºé™åˆ¶é€’å½’æå–æ·±åº¦ï¼Œé»˜è®¤æ·±åº¦ä¸º8ï¼Œä»…å½“â€œ-M"é€‰é¡¹å­˜åœ¨æ—¶æœ‰æ•ˆã€‚

ã€€ã€€å‘½ä»¤   dd if=ï¼ˆåŸæ–‡ä»¶åï¼‰ of=ï¼ˆæå–æ–‡ä»¶åï¼‰skip=æ•°æ®åœ°å€ bs=1

2.3ã€æ˜¾ç¤ºå®Œæ•´çš„æ‰«æç»“æœ

ã€€ã€€å‘½ä»¤ï¼šbinwalk -I firmware.bin      é€‰é¡¹"-I"å’Œâ€œ--invalid"ç”¨äºæ˜¾ç¤ºæ‰«æçš„æ‰€æœ‰ç»“æœï¼ˆå³ä½¿æ˜¯æ‰«æè¿‡ç¨‹ä¸­è¢«å®šä¹‰ä¸ºâ€œinvalidâ€œçš„é¡¹ï¼‰ã€‚å½“æˆ‘ä»¬è®¤ä¸ºbinwalké”™æŠŠæœ‰æ•ˆçš„æ–‡ä»¶å½“æˆæ— æ•ˆæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡è¯¥é€‰é¡¹æ¥æ£€æŸ¥ã€‚

## 6.foremostçš„ä½¿ç”¨ã€‚
1ã€foremoståœ¨kali linuxå·²ç»é¢„è£…ã€‚
#apt-get install foremost

2ã€ç„¶åçœ‹æ˜¯å¦ä¸‹è½½æˆåŠŸï¼Œè¾“å…¥

> foremost -h

ä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼ˆå·²ç»ç¿»è¯‘ï¼‰

```
$ foremost [-v|-V|-h|-T|-Q|-q|-a|-w-d] [-t <type>] [-s <blocks>] [-k <size>] 
    [-b <size>] [-c <file>] [-o <dir>] [-i <file] 

-V  - æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯å¹¶é€€å‡º
-t  - æŒ‡å®šæ–‡ä»¶ç±»å‹.  (-t jpeg,pdf ...) 
-d  -æ‰“å¼€é—´æ¥å—æ£€æµ‹ (é’ˆå¯¹UNIXæ–‡ä»¶ç³»ç»Ÿ) 
-i  - æŒ‡å®šè¾“å…¥æ–‡ä»¶ (é»˜è®¤ä¸ºæ ‡å‡†è¾“å…¥) 
-a  - å†™å…¥æ‰€æœ‰çš„æ–‡ä»¶å¤´éƒ¨, ä¸æ‰§è¡Œé”™è¯¯æ£€æµ‹(æŸåæ–‡ä»¶) 
-w  - å‘ç£ç›˜å†™å…¥å®¡è®¡æ–‡ä»¶ï¼Œä¸å†™å…¥ä»»ä½•æ£€æµ‹åˆ°çš„æ–‡ä»¶
-o  - è®¾ç½®è¾“å‡ºç›®å½• (é»˜è®¤ä¸ºä¸ºè¾“å‡º)
-c  - è®¾ç½®é…ç½®æ–‡ä»¶ (é»˜è®¤ä¸º foremost.conf)
-q  - å¯ç”¨å¿«é€Ÿæ¨¡å¼. åœ¨512å­—èŠ‚è¾¹ç•Œæ‰§è¡Œæœç´¢.
-Q  - å¯ç”¨å®‰é™æ¨¡å¼. ç¦ç”¨è¾“å‡ºæ¶ˆæ¯. 
-v  - è¯¦ç»†æ¨¡å¼. å‘å±å¹•ä¸Šè®°å½•æ‰€æœ‰æ¶ˆæ¯ã€‚

```
ctfæ–‡ä»¶åˆ†ç¦»çš„é¢˜ç›®ï¼Œå¤§å¤šæ—¶å€™å¯ä»¥ä½¿ç”¨binwalkæˆ–è€…winhexä¹Ÿå¯ä»¥ä½¿ç”¨ddå‘½ä»¤ã€‚å¯ä»¥ä½¿ç”¨foremostï¼Œç›¸å¯¹æ¥è¯´binwalkæ›´åŠ å¼ºå¤§ï¼Œé€Ÿåº¦ä¹Ÿå¿«ï¼Œä½†æ˜¯æœ‰æ—¶å€™å¦‚æœä¸èƒ½åˆ†ç¦»å‡ºæ¥ï¼Œå°±å¯ä»¥è¯•è¯•çœ‹foremostã€‚

æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•å°±æ˜¯å°†å›¾ç‰‡æ”¾è¿›foremostç›®å½•ä¸‹ï¼Œè¾“å…¥å‘½ä»¤ï¼š

```
 foremost -i xxx.jpg
```
åœ¨ç›®å½•ä¸‹ä¼šå‡ºç°ä¸€ä¸ªoutputæ–‡ä»¶å¤¹ï¼Œåˆ†ç¦»å‡ºçš„ç»“æœä¼šåœ¨é‡Œé¢ã€‚


å·¥å…·å°±è¯´åˆ°è¿™ï¼Œåé¢è‚¯å®šè¿˜ä¼šæœ‰ï¼ï¼ï¼
